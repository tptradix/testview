<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Open</title>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Bungee&family=Bungee+Spice&family=Lato:ital,wght@0,100;0,300;0,400;0,700;0,900;1,100;1,300;1,400;1,700;1,900&family=Monoton&family=Paytone+One&family=Poppins&family=Ramabhadra&family=Ubuntu:ital,wght@0,300;0,400;0,500;0,700;1,300;1,400;1,500;1,700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="pin.css">
</head>
<body style="margin: 0; padding: 0; height: 100vh; background: var(--tg-theme-bg-color);">
    <div class="main">
        <form method="POST" >
            <div class="root">
                <div>
                    <div style="display: flex; justify-content: center; margin-top: 10%;">
                        <h1 class="inf">Set up a pin code</h1>
                    </div>
                </div>
                <div>
                    <div class="pin_decode" style="transform: none;">
                        <div class="pin" id="pin_1"></div>
                        <div class="pin" id="pin_2"></div>
                        <div class="pin" id="pin_3"></div>
                        <div class="pin" id="pin_4"></div>
                    </div>
                </div>
                <div class="input_frame">
                    <div id="1" class="type_btn" type="button">
                        <p class="code">1</p>
                    </div>
                    <div id="2" class="type_btn" type="button">
                        <p class="code">2</p>
                    </div>
                    <div id="3" class="type_btn" type="button">
                        <p class="code">3</p>
                    </div>
                    <div id="4" class="type_btn" type="button">
                        <p class="code">4</p>
                    </div>
                    <div id="5" class="type_btn" type="button">
                        <p class="code">5</p>
                    </div>
                    <div id="6" class="type_btn" type="button">
                        <p class="code">6</p>
                    </div>
                    <div id="7" class="type_btn" type="button">
                        <p class="code">7</p>
                    </div>
                    <div id="8" class="type_btn" type="button">
                        <p class="code">8</p>
                    </div>
                    <div id="9" class="type_btn" type="button">
                        <p class="code">9</p>
                    </div>
                    <div></div>
                    <div id="0" class="type_btn" type="button">
                        <p class="code">0</p>
                    </div>
                    <div id="del" style="display: flex; align-items: center; justify-content: center;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="var(--tg-theme-hint-color)"><path d="M20.25 3.75H6.42188C6.16324 3.75243 5.90951 3.82088 5.68474 3.94885C5.45997 4.07683 5.2716 4.26008 5.1375 4.48125L0.853126 11.6156C0.783763 11.7318 0.747141 11.8647 0.747141 12C0.747141 12.1353 0.783763 12.2682 0.853126 12.3844L5.1375 19.5187C5.27093 19.7405 5.45914 19.9243 5.68406 20.0523C5.90898 20.1804 6.16306 20.2485 6.42188 20.25H20.25C20.6478 20.25 21.0294 20.092 21.3107 19.8107C21.592 19.5294 21.75 19.1478 21.75 18.75V5.25C21.75 4.85218 21.592 4.47064 21.3107 4.18934C21.0294 3.90804 20.6478 3.75 20.25 3.75ZM15.5344 13.7156C15.6752 13.8578 15.7542 14.0499 15.7542 14.25C15.7542 14.4501 15.6752 14.6422 15.5344 14.7844C15.3894 14.9204 15.1988 14.9973 15 15C14.8008 14.9992 14.6096 14.922 14.4656 14.7844L12.75 13.0594L11.0344 14.7844C10.8894 14.9204 10.6988 14.9973 10.5 15C10.3008 14.9992 10.1096 14.922 9.96563 14.7844C9.82479 14.6422 9.74578 14.4501 9.74578 14.25C9.74578 14.0499 9.82479 13.8578 9.96563 13.7156L11.6906 12L9.96563 10.2844C9.84603 10.1387 9.78491 9.95366 9.79416 9.76537C9.8034 9.57708 9.88236 9.39896 10.0157 9.26566C10.149 9.13236 10.3271 9.0534 10.5154 9.04416C10.7037 9.03491 10.8887 9.09603 11.0344 9.21563L12.75 10.9406L14.4656 9.21563C14.6113 9.09603 14.7963 9.03491 14.9846 9.04416C15.1729 9.0534 15.351 9.13236 15.4843 9.26566C15.6176 9.39896 15.6966 9.57708 15.7058 9.76537C15.7151 9.95366 15.654 10.1387 15.5344 10.2844L13.8094 12L15.5344 13.7156Z"></path></svg>
                    </div>
                </div>
            </div>
        </form>
        <input id="put" name="put" style="display: none;" value="">
        <input id="qst" name="qst" style="display: none;" value=""> 
    </div>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script>
        let tg = window.Telegram.WebApp;
        tg.MainButton.setText("Continue");
        tg.MainButton.show();
        tg.MainButton.color = '#737373';
        tg.MainButton.isActive = false;
    </script>
    <script>
        document.body.onselectstart = function() { return false; }
        document.body.onmousedown = function() { return false; }
        let click = document.querySelectorAll('.type_btn')
        click.forEach(click => {
            let btn = document.getElementById(click.id);
            btn.addEventListener('click', () => {
                let pin = ((btn.textContent).toString().replace("\/s+/g", ''))
                if (document.getElementById('put').value.length < 4 ) {
                    document.getElementById('put').value = document.getElementById('put').value + pin.trim();
                    console.log(document.getElementById('put').value)
                    if ((document.getElementById('put').value).length == 1 ) {
                        document.getElementById('pin_1').style.background = '#3390ec'
                    }
                    if ((document.getElementById('put').value).length == 2 ) {
                        document.getElementById('pin_1').style.background = '#3390ec'
                        document.getElementById('pin_2').style.background = '#3390ec'
                    }
                    if ((document.getElementById('put').value).length == 3 ) {
                        document.getElementById('pin_1').style.background = '#3390ec'
                        document.getElementById('pin_2').style.background = '#3390ec'
                        document.getElementById('pin_3').style.background = '#3390ec'
                    }
                    if ((document.getElementById('put').value).length == 4 ) {
                        document.getElementById('pin_1').style.background = '#3390ec'
                        document.getElementById('pin_2').style.background = '#3390ec'
                        document.getElementById('pin_3').style.background = '#3390ec'
                        document.getElementById('pin_4').style.background = '#3390ec'
                        if (document.getElementById('qst').value == document.getElementById('put').value) {
                            tg.MainButton.setText("Submit");
                            tg.MainButton.show();
                            tg.MainButton.isActive = true;
                        }
                        else {
                            if (document.getElementById('qst').value.length == 0) {
                                console.log('No')
                                let tg = window.Telegram.WebApp;
                                tg.MainButton.setText("Continue");
                                tg.MainButton.show();
                                tg.MainButton.isActive = true;
                                tg.MainButton.color = "#2481cc";
                                Telegram.WebApp.onEvent("mainButtonClicked", function() {
                                    document.getElementById('qst').value = document.getElementById('put').value
                                    document.getElementById('put').value = ''
                                    document.getElementById('pin_4').style.background = '#737373'
                                    document.getElementById('pin_3').style.background = '#737373'
                                    document.getElementById('pin_2').style.background = '#737373'
                                    document.getElementById('pin_1').style.background = '#737373'
                                    document.querySelector('.inf').innerText = 'Repeat the pin code'
                                    tg.MainButton.isActive = false;
                                    tg.MainButton.setText(document.getElementById('qst').value);
                                    tg.MainButton.color = "#31b545";
                                    document.getElementById('del').style.display = 'none'
                                });
                            }
                            else {
                                document.getElementById('qst').value = document.getElementById('put').value;
                                document.getElementById('put').value = ''
                                document.getElementById('pin_4').style.background = '#737373'
                                document.getElementById('pin_3').style.background = '#737373'
                                document.getElementById('pin_2').style.background = '#737373'
                                document.getElementById('pin_1').style.background = '#737373'
                                document.querySelector('.inf').innerText = 'Repeat the pin code'
                            }
                        }
                    }
                }
            })
        })
        document.getElementById('del').addEventListener('click', () => {
            function back() {
                if (document.getElementById('put').value.length > 0) {
                    document.getElementById('put').value = document.getElementById('put').value.slice(0, -1)
                    console.log(document.getElementById('put').value)
                }
                if ((document.getElementById('put').value).length == 4 ) {
                        document.getElementById('pin_4').style.background = '#737373'
                    }
                if ((document.getElementById('put').value).length == 3 ) {
                    document.getElementById('pin_4').style.background = '#737373'
                    
                }
                if ((document.getElementById('put').value).length == 2 ) {
                    document.getElementById('pin_3').style.background = '#737373'
                }
                if ((document.getElementById('put').value).length == 1 ) {
                    document.getElementById('pin_4').style.background = '#737373'
                    document.getElementById('pin_3').style.background = '#737373'
                    document.getElementById('pin_2').style.background = '#737373'
                    document.getElementById('pin_4').style.background = '#737373'
                }
                if ((document.getElementById('put').value).length == 0 ) {
                    document.getElementById('pin_4').style.background = '#737373'
                    document.getElementById('pin_3').style.background = '#737373'
                    document.getElementById('pin_2').style.background = '#737373'
                    document.getElementById('pin_1').style.background = '#737373'
                }
            }
            if (document.getElementById('qst').value.length == 0) {
                let tg = window.Telegram.WebApp;
                tg.MainButton.setText("Continue");
                tg.MainButton.show();
                tg.MainButton.color = '#737373'
                tg.MainButton.isActive = false;
                back();
            }
            if (document.getElementById('qst').value.length != 0) {
                let tg = window.Telegram.WebApp;
                tg.MainButton.hide();
                back();
            }
        })
    </script>
</body>
</html>
